{% extends 'base.html' %}
{% load static %}

{% block title %}рдЯреЛрдХрди рджреЗрдЦреЗрдВ{% endblock %}

{% block content %}
<div class="container mt-4">

  <h2 class="mb-4">ЁЯФН рдЕрдкрдирд╛ рдЯреЛрдХрди рджреЗрдЦреЗрдВ</h2>

  <form method="post">
    {% csrf_token %}
    <div class="mb-3">
      <label for="contact_number" class="form-label">рдЕрдкрдирд╛ рд╕рдВрдкрд░реНрдХ рдирдВрдмрд░ рджрд░реНрдЬ рдХрд░реЗрдВ:</label>
      <input type="text" name="contact_number" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-success">ЁЯФН рдЯреЛрдХрди рдЦреЛрдЬреЗрдВ</button>
  </form>

  {% if token %}
    <div class="mt-4 card p-3">
      <h4>ЁЯОЯя╕П рдЯреЛрдХрди рд╡рд┐рд╡рд░рдг</h4>
      <p><strong>рдирд╛рдо:</strong> {{ token.farmer.name }}</p>
      <p><strong>рдлрд╕рд▓ рдХрд╛ рдкреНрд░рдХрд╛рд░:</strong> {{ token.crop_type }}</p>
      <p><strong>рдЖрдЧрдорди рд╕рдордп:</strong> {{ token.estimated_arrival_time|date:"d F Y - g:i a" }}</p>
      <p><strong>рд╕реНрдерд┐рддрд┐:</strong> {{ token.token_status }}</p>

      {% if token.token_status == 'active' %}
      <form method="post" action="{% url 'cancel_token' token.id %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger mt-2">ЁЯЪл рдЯреЛрдХрди рд░рджреНрдж рдХрд░реЗрдВ</button>
      </form>
      {% endif %}
    </div>

  {% elif not_found %}
    <div class="alert alert-warning mt-3">
      тЭЧ рдЗрд╕ рдирдВрдмрд░ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдЯреЛрдХрди рдирд╣реАрдВ рдорд┐рд▓рд╛ред
    </div>
  {% endif %}

  <div class="text-end mt-3">
    <a href="{% url 'home' %}" class="btn btn-primary">ЁЯПа рд╣реЛрдо рдкрд░ рд▓реМрдЯреЗрдВ</a>
  </div>

</div>
{% endblock %}
